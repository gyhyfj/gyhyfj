# å‡½æ•°

å‡½æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡

## ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«

1. ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this, ä¸èƒ½é€šè¿‡ call apply bind æ”¹å˜ç®­å¤´å‡½æ•°ä¸­çš„ this æŒ‡å‘
2. ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ arguments å¯¹è±¡, ä½†ä»å¯ä½¿ç”¨å‰©ä½™å‚æ•° rest
3. ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype
4. ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œç”Ÿæˆå™¨
5. ç®­å¤´å‡½æ•°æ²¡æœ‰å˜é‡æå‡åŠŸèƒ½
6. ç®­å¤´å‡½æ•°æ›´åŠ ç®€æ´

## å¯é€‰å‚æ•°

ä¸€èˆ¬çš„å‡½æ•°çš„å½¢å‚éƒ½æ˜¯ç”¨é€—å·éš”å¼€çš„ä¸€ä¸ªä¸ªå½¢å‚å˜é‡å,
å¦‚æœæ˜¯å¯é€‰å‚æ•°, ts ä¸‹å°±åœ¨ç±»å‹å‰åŠ é—®å·, ä¸”ä¸å†åƒ js é‚£æ ·å¿…é¡»æ”¾åœ¨å½¢å‚è¡¨å°¾ã€‚å¦‚æœæ˜¯å¯é€‰ä¸”æœ‰é»˜è®¤å€¼å‚æ•°, å°±ä¸åŠ ç±»å‹çº¦æŸ, ç›´æ¥ç”¨ç­‰å·èµ‹å€¼é»˜è®¤å€¼

```ts
const fn = (a?: number, b?: number, c?: number) => ({
  a,
  b,
  c,
})

console.log(fn(1, 2, 3)) // { a: 1, b: 2, c: 3 }
console.log(fn(1, 2)) // { a: 1, b: 2, c: undefined }

/* é‚£ä¹ˆå¦‚æœåªåƒç»™aå’Œcä¼ å‚å‘¢ï¼Ÿå°±å¿…é¡»ä¸»åŠ¨ç»™bä¼ ä¸ªundefinedä»¥ç»´æŒä¼ å€¼ç»™æ­£ç¡®çš„å½¢å‚ */
console.log(fn(1, undefined, 3)) // { a: 1, b: undefined, c: 3 }
```

## å½¢å‚ä¸ºå¯¹è±¡çš„å‡½æ•°

```ts
// ä¸‹ä¾‹ä¸­çš„numberè¡¨ç¤ºæ˜¯å‚æ•°çš„é‡å‘½å
const fn = ({ a: number }) => {
  // ç»‘å®šå…ƒç´ â€œnumberâ€éšå¼å…·æœ‰â€œanyâ€ç±»å‹
  console.log(number)
  console.log(a) // error æ‰¾ä¸åˆ°åç§°â€œaâ€
}

// ä¸‹é¢çš„numberè¢«è®¤ä¸ºæ˜¯ç±»å‹, ä¸å¯ä»¥è¿™æ ·å†™
const fn = ({ a?: number }) => { // error numberâ€ä»…è¡¨ç¤ºç±»å‹, ä½†åœ¨æ­¤å¤„å´ä½œä¸ºå€¼ä½¿ç”¨
  console.log(1)
}

const fn = ({ a: number }: any) => {
  // ç»‘å®šå…ƒç´ â€œnumberâ€éšå¼å…·æœ‰â€œanyâ€ç±»å‹
  console.log(number)
}
fn({ a: 1 }) // 1
fn({ b: 1 }) // undefined
```

æ‰€ä»¥æ€ä¹ˆç†è§£å½¢å‚æ˜¯ä¸€ä¸ªå¯¹è±¡? åªæ˜¯å¯¹ä¼ å…¥å®å‚çš„è§£æ„å–å€¼è€Œå·²
å› æ­¤å¯ä»¥ä¸ç”¨å†’å·é‡å‘½å, ç›´æ¥æŒ‡å®šæ¥æ”¶çš„å˜é‡å:

```ts
const fn = ({ a, b, c }: any, d?: number) => ({
  a,
  b,
  c,
})

console.log(fn({ a: 1, c: 3 })) // { a: 1, b: undefined, c: 3 }
```

## æ¥æ”¶å¼•ç”¨ç±»å‹çš„å‚æ•°

æ¥å—å¯¹è±¡è¿™æ ·çš„å¼•ç”¨ç±»å‹çš„å‚æ•°, å¦‚æœåœ¨ä¸æ”¹å˜å®ƒæŒ‡å‘çš„æ“ä½œä¸‹å¯¹å®ƒåšä¿®æ”¹, æºæ•°æ®ä¹Ÿä¼šæ”¹å˜, å› ä¸ºæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿
å¦‚æœæ˜¯é‡æ–°èµ‹å€¼ä¸€ä¸ªæ–°å¯¹è±¡, å› ä¸ºæŒ‡å‘æ”¹å˜äº†, æ‰€ä»¥ä¸ä¼šä¿®æ”¹æºæ•°æ®

```ts
const z = { x: 1 }

const fn = obj => {
  // Object.assign(obj, { y: 1 }) // Object.assignæ–¹æ³•ä¼šæ”¹å˜å‡½æ•°å¤–çš„obj

  obj = {
    y: 1,
    ...obj,
  } // å› ä¸ºåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡èµ‹å€¼ç»™obj, æ‰€ä»¥ä¸ä¼šæ”¹å˜å‡½æ•°å¤–çš„obj
}

fn(z)

console.log(z)
```

## å‡½æ•°ä»¥æ¨¡æ¿å­—ç¬¦ä¸²çš„å½¢å¼è°ƒç”¨

å‡½æ•°ä»¥æ¨¡æ¿å­—ç¬¦ä¸²çš„å½¢å¼è°ƒç”¨æ—¶, ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„, ä¸ºè¢«å ä½èŠ‚ç‚¹ split å¾—åˆ°çš„å­—ç¬¦ä¸²æ•°ç»„, åé¢çš„å‚æ•°ä¾æ¬¡æ˜¯æ¯ä¸ªå ä½èŠ‚ç‚¹ä¸­çš„å†…å®¹

```ts
const fn = (...args: any[]) => {
  console.log(...args)
}

fn`hello, ${1}${2}` // [ 'hello, ', '', '' ] 1 2
```

## è‡ªæ‰§è¡ŒåŒ¿åå‡½æ•°

åœ¨å‡½æ•°å£°æ˜ä¸Šæ·»åŠ `()` æˆ– åœ¨å‰é¢åŠ `!`ç­‰è¿ç®—ç¬¦å‘Šè¯‰ JS è§£æå™¨ï¼Œä½¿å‡½æ•°å£°æ˜æˆä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œç„¶åè°ƒç”¨å®ƒ
æœ€å¥½ä½¿ç”¨æ‹¬å·å¹¶ä¸”å‰é¢åŠ åˆ†å·é¿å…æ­§ä¹‰å¹¶æé«˜æ€§èƒ½

```ts
;((n: number) => console.log(n))(3)
;(function () {
  console.log(9)
})()
```

è‡ªæ‰§è¡Œå‡½æ•°å¯ä»¥å’ŒæŸ¯é‡ŒåŒ–ä¸€èµ·ä½¿ç”¨

```ts
const getAliSignature = (
  (initTime = 0, secret?: AliSignature) =>
  () =>
    new Promise<AliSignature>((resolve, reject) => {
      if (Date.now() / 1000 - initTime + 60 > (secret?.expire ?? 0)) {
        netGetALiSignature()
          .then(res => {
            secret = res
            resolve(secret as AliSignature)
          })
          .catch(() => {
            reject('ğŸ™ƒGet ali signature failed!')
          })
      } else {
        resolve(secret as AliSignature)
      }
    })
)()
```
