# 声明合并

TypeScript 中的声明会创建以下三种实体之一：命名空间，类型或值。
创建命名空间的声明会新建一个命名空间，它包含了用（.）符号来访问时使用的名字。
创建类型的声明是：用声明的模型创建一个类型并绑定到给定的名字上。
创建值的声明会创建可以在 JavaScript 输出中看到的值。

| Declaration Type | Namespace | Type | Value |
| ---------------- | :-------: | :--: | :---: |
| Namespace        |     ✓     |      |   ✓   |
| Class            |           |  ✓   |   ✓   |
| Enum             |           |  ✓   |   ✓   |
| Interface        |           |  ✓   |       |
| Type Alias       |           |  ✓   |       |
| Function         |           |      |   ✓   |
| Variable         |           |      |   ✓   |

## 合并接口

合并的机制是把双方的成员放到一个同名的接口里。

合并的前提是：
接口的非函数的成员应该是唯一的。如果它们不是唯一的，那么它们必须是相同的类型。如果两个接口中同时声明了同名的非函数成员且它们的类型不同，则编译器会报错。

对于函数成员，每个同名函数声明都会被当成这个函数的一个重载。

优先级：当接口 A 与后来的接口 A 合并时，后面的（写在下面的）接口具有更高的优先级，后来的接口重载出现在靠前位置。

这个规则有一个例外是：当出现特殊的函数签名时。 如果签名里有一个参数的类型是**单一**的字符串字面量（不可以是字符串字面量的联合类型），那么它将会被提升到重载列表的最顶端。

## 合并命名空间

命名空间会创建出命名空间和值
命名空间合并时，
导出的同名接口会发生合并，
导出的值，后来的命名空间的会被加到已经存在的那个模块里，
非导出成员仅在其原有的（合并前的）命名空间内可见，从其它命名空间合并进来的成员无法访问非导出成员。

## 命名空间与类和函数和枚举类型合并

命名空间可以与其它类型的声明进行合并，只要命名空间的定义符合将要合并类型的定义。合并结果包含两者的声明类型。

### 命名空间与函数的合并

在 JavaScript 里，创建一个函数稍后扩展它增加一些属性也是很常见的。 TypeScript 使用声明合并来达到这个目的并保证类型安全。
即创建一个函数后，再创建同名的命名空间，使用 export 导出的成员会挂载到原函数上

```ts
function buildLabel(name: string): string {
  return buildLabel.prefix + name + buildLabel.suffix
}

namespace buildLabel {
  export let suffix = ''
  export let prefix = 'Hello, '
}

console.log(buildLabel('Sam Smith'))
```

### 命名空间与枚举的合并

先创建一个枚举，再创建同名的命名空间，使用 export 导出的成员会挂载到原枚举上
但不可以与 const 枚举合并

场景：
在使用枚举时，往往会需要一个辅助函数去展示属性的值，这个时候可以配合 namespace

这样写的一个好处就是枚举合辅助方法能保持在同一命名空间下，维护方便。缺点就是如果需要遍历枚举的属性，就会多出命名空间中方法属性。
