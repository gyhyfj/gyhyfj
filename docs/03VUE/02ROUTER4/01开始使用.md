# 开始使用

https://router.vuejs.org/zh/

## 安装 `npm i vue-router`

## 创建`src/router/index.ts`

## 配置一个基础路由，然后导出 route：

```ts
import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'

const routes: Array<RouteRecordRaw> = [
  {
    path: '/',
    component: () => import('../components/Login.vue'), // 注意这种行内回调函数import组件的写法
  },
  {
    path: '/reg',
    component: () => import('../components/Regester.vue'),
  },
]

const router = createRouter({
  history: createWebHistory(),
  routes,
})

export default router // 导出router
```

## 在`main.ts`中注册 router 插件

```ts {4,8}
import { createApp } from 'vue'
import './style.css'
import App from './App.vue'
import router from './router'

const app = createApp(App)

app.use(router)
app.mount('#app')
```

## 在`App.vue`中使用

```vue {5,8,9}
<script lang="ts" setup></script>

<template>
  <!-- 容器来存放 -->
  <router-view></router-view>

  <!-- 链接 -->
  <router-link to="/">Login</router-link>
  <router-link to="/reg">Reg</router-link>
</template>

<style lang="less" scoped></style>
```

## 路由跳转与传参

有 router-link 导航和编程式导航两种方式
两种都可以可以通过 path 跳转，也可以通过 name 跳转

1. 用`<router-link to="/"></router-link>`组件，配置`to`属性

```vue
<router-link to="/">Login</router-link>
<!-- to 接受一个字符串 -->
<router-link
  :to="{ name: 'user', params: { username: 'erina' } }"
>User</router-link>
<!-- to 接受一个对象 -->
```

2. 编程式导航
   有 push replace go 三种方法，模仿 window.history 的 API

```ts
// 字符串路径
router.push('/user')
// 带path的对象
router.push({ path: '/user' })
// 带name的对象，跳转到命名路由
router.push({ name: 'user' })
// 带params，让路由建立url
// 注意：如果提供了path，params会被忽略，所以只能用命名导航
router.push({ name: '/user', params: { username: 'eduardo' } })
// 带查询参数query
router.push({ path: '/user', query: { username: 'eduardo' } })
// 带hash
router.push({ path: '/about', hash: '#team' })
```

注意：
使用 params 时必须用 name 而不是 path 进行导航
使用 query 则不受影响
一种解决方案：
用模板字符串建立 url 地址

```ts
// 我们可以手动建立 url，但我们必须自己处理编码
const username = 'eduardo'
router.push(`/user/${username}`) // -> /user/eduardo
// 同样
router.push({ path: `/user/${username}` }) // -> /user/eduardo
```

注意：
params 传参，参数不会展示在 url 上，而是存在内存里，
通过`route.params.keyname`来取用。

因为是所传参数是存在内存里的，所以跳转后页面一刷新，传递的值会丢失，

为了解决这个问题，可以使用动态路由参数，
只要在 routes 节点配置好动态路由即可，
push 函数仍是原来的写法，
仍通过`route.params.keyname`来取用，但刷新页面不再丢失传来的数据

## 全局注入

$route 和 $router

$route.path 也是一个 Proxy 对象
