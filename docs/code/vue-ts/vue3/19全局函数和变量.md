# 全局函数和变量

由于 Vue3 没有 Prototype 属性 使用 app.config.globalProperties 代替 然后去定义变量和函数

Vue2

```js
// 之前 (Vue 2.x)
Vue.prototype.$http = () => {}
```

Vue3

```js
// 之后 (Vue 3.x)
const app = createApp({})
app.config.globalProperties.$http = () => {}
```

由于 Vue3 移除了过滤器，正好可以用全局函数代替过滤器 Filters
也可以定义全局变量

```ts
/* main.ts */
import { createApp } from 'vue'
import './style.css'
import App from './App.vue'

const app = createApp(App)

/* $filters的声明文件 */
type Filter = {
  format: <T>(str: T) => string
}
// 声明要扩充@vue/runtime-core包的声明.
// 这里扩充"ComponentCustomProperties"接口, 因为他是vue3中实例的属性的类型.
declare module '@vue/runtime-core' {
  export interface ComponentCustomProperties {
    $filters: Filter
    $env: string
  }
}
/* $filters是一个对象，里面可以有各种函数 */
app.config.globalProperties.$filters = {
  format<T extends any>(str: T): string {
    return `真·${str}`
  },
}

/* 还可以直接定义变量 */
app.config.globalProperties.$env = 'dev'

app.mount('#app')
```

然后在 vue 文件中可以直接调用全局函数或全局变量

```vue
<!-- App.vue -->
<template>{{ $filters.format('123') }}<br />{{ $env }}</template>
```

```js
import { getCurrentInstance, ComponentInternalInstance } from 'vue';

const { appContext } = <ComponentInternalInstance>getCurrentInstance()

console.log(appContext.config.globalProperties.$env);
```

还可以定义一些
