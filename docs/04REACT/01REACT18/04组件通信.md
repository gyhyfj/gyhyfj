# 组件通信

## 父传子

props 传参

1. 父组件提供要传递的数据 `<Son msg={this.state.message} />`
2. 子组件中通过 props 接收父组件中传过来的数据
   a. 类组件使用 this.props 获取 props 对象 `this.props.msg`
   b. 函数式组件直接通过参数获取 props 对象 `props.msg`

注意：
props 是只读对象
props 可以传递任意数据 （包括函数和 JSX）

进阶：
children 属性
props 校验-场景和使用 https://www.yuque.com/fechaichai/qeamqf/xbai87#4e4ef7cd

## 子传父

父组件给子组件传递回调函数，子组件调用

1. 父组件提供一个回调函数，带有一个形参，用于接收数据
2. 父组件将函数通过 props 传给子组件
3. 子组件通过 props 调用这个函数，并注入参数

## 兄弟组件通信

通过状态提升机制，利用共同的父组件实现兄弟通信

1. 将共享状态提升到最近的公共父组件中，由公共父组件管理这个状态
   父组件提供共享状态
   父组件提供操作共享状态的方法
2. 要接收数据状态的子组件通过 props 接收数据
3. 要传递数据状态的子组件通过 props 接收方法，调用方法传递数据

## 跨组件通信

Context 提供了一个无需为每层组件手动添加 props，就能在组件树间进行数据传递的方法
TODO: 貌似只用于类组件？

1. 创建 Context 对象 导出 Provider 和 Consumer 对象
   `const { Provider, Consumer } = createContext()`
2. 使用 Provider 包裹上层组件提供数据
   `<Provider value={this.state.message}> {/* 根组件 */} </Provider>`
3. 需要用到数据的组件使用 Consumer 包裹获取数据
   `<Consumer > {value => /* 基于 context 值进行渲染*/} </Consumer>`
